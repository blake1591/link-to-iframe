<!doctype html>
<html lang="en">

<head>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Link to Iframe</title>
    <meta name="description" content="A simple HTML page where you can input a link and it will fill an iframe. Other features include light and dark modes, navigation buttons, autocomplete links (beta), and a drop-down menu of recommended sites.">
    <link href='/style.css' rel='stylesheet'>
    <style>
        body {
            background-color: #f4f4f4;
            color: #333;
        }

        body.dark-mode {
            background-color: #333;
            color: #f4f4f4;
        }

        /* Add more styles for dark mode elements if needed */
        body.dark-mode input,
        body.dark-mode select,
        body.dark-mode button {
            background-color: #555;
            color: #fff;
        }

        body.dark-mode .suggestion-item {
            color: white;
            background-color: #444;
            /* Slightly darker than #333 */

        }
        .button-background {
            padding: 8px 12px;
            border: 1px solid #ccc;
            background-color: white;
        }
    </style>
    <style>
        #backButton,
        #forwardButton {
            font-size: 16px;
        }

        #reloadButton {
            font-size: 17px
        }

    </style>
    </style>


<body title="main page">
    <p style="font-size: 14px; font-family: sans-serif;">Enter a site you would like to visit without any blocking.
        Some

        websites do not allow their site into an iframe (which is the box where the website is in). </p>
    
    <input type="text" id="linkInput" placeholder="Enter a link">
    <button id="loadButton" style="border-radius: 5px;">Load Link</button> <button id="backButton" style="border-radius: 5px;">←</button>
    <button id="forwardButton" style="border-radius: 5px;">→</button>
    <div id="suggestionBox" style="display: none; position: absolute; border: 1px solid #ccc; background-color: white; max-height: 150px; overflow-y: auto;">
        <!-- Suggestions will be added here -->        
    </div>
    <style>
           .suggestion-item {
            padding: 5px;
            cursor: pointer;
        }
    </style>
    <button id="reloadButton" style="border-radius: 5px;">⟳</button>
    
    <select id="linkDropdown">
        <option value="">-- Select a site --</option>
        <option value="https://sz-games.github.io/">Games</option>
        <option value="https://example.com">Example</option>   
    </select>
      <div style="position: fixed; top: 30px; right: 30px; display: flex; gap: 20px; align-items: center;">
<button id="darkModeToggle" class="button-background" style="border-radius: 5px;">
    <span id="darkModeIcon" class="material-icons">dark_mode</span>
    </button>
    

          <button id="settingsButton" style="display: flex; align-items: center; justify-content: center; padding: 0; background: none; border: none; cursor: pointer; width: 30px; height: 30px; border-radius: 5px;">
        <div id="settingsIconContainer" class="button-background" style="width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">
        <style>
        #settingsIconContainer{
            border-radius:5px;
        }
    </style>
    <i class="material-icons" id="materialSettingsIcon">settings</i>
    </svg>
</button>
        <style>
    .material-icons {
        font-family: 'Material Icons';
        font-weight: normal;
        font-style: normal;
        font-size: 24px; /* Preferred icon size */
        display: inline-block;
        line-height: 1;
        text-transform: none;
        letter-spacing: normal;
        word-wrap: normal;
        white-space: nowrap;
        direction: ltr;
        
    }
</style>
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    </div>
    <iframe id="myIframe" title="website" style="width: 100%; height: calc(100vh - 100px);" frameborder="0" allowfullscreen src="about:blank"></iframe>
    <style>
     </style>
    <script >
        const suggestionBox = document.getElementById('suggestionBox');

        function showSuggestions(suggestions) {
            suggestionBox.innerHTML = '';
            if (suggestions.length > 0) {
                suggestions.forEach(suggestion => {
                    const item = document.createElement('div');
                    item.classList.add('suggestion-item');
                    item.textContent = suggestion;
                    item.addEventListener('click', () => {
                        linkInput.value = suggestion;
                        suggestionBox.style.display = 'none';
                    });
                    suggestionBox.appendChild(item);
                });
                suggestionBox.style.display = 'block';
            } else {
                suggestionBox.style.display = 'none';
            }
        }

        // Function to filter suggestions based on the input value
        function filterSuggestions(value) {
            const allOptions = Array.from(document.getElementById('linkDropdown').options).map(option => option.value);

            if (value.trim() === '') {
                return [];
            } else {
                return allOptions.filter(option => option.toLowerCase().includes(value.toLowerCase()));
            }

        }

        // Function to position the suggestion box below the input
        function positionSuggestionBox() {
            const inputRect = linkInput.getBoundingClientRect();
            suggestionBox.style.left = `${inputRect.left}px`;
            suggestionBox.style.top = `${inputRect.bottom}px`;
            suggestionBox.style.width = `${inputRect.width}px`;
        }

        // Event listener for input changes
        linkInput.addEventListener('input', () => {
            const suggestions = filterSuggestions(linkInput.value);
            showSuggestions(suggestions);
            positionSuggestionBox();
        });

        document.getElementById('loadButton').addEventListener('click', function () {
            loadIframe(document.getElementById('linkInput').value);
        });
        const iframe = document.getElementById('myIframe');

        // Event listener to hide the suggestion box when clicking outside
        document.getElementById('reloadButton').addEventListener('click', function () {
            const currentUrl = document.getElementById('myIframe').src;
            if (currentUrl) {
            }
        });
        document.getElementById('backButton').addEventListener('click', function () {
            history.back();
        });

        document.getElementById('forwardButton').addEventListener('click', function () {
            history.forward();
        });        
        
         if (localStorage.getItem('darkMode') === 'enabled') {
            document.body.classList.add('dark-mode');
            document.getElementById('darkModeIcon').textContent = '☀️';
        }

        document.getElementById('linkDropdown').addEventListener('change', function () {
            loadIframe(this.value);
        });
        
          function loadIframe(url) {
              if (url) {
                iframe.src = url;
                history.pushState({ url: url }, '', url);

            }
    }

    
         // Handle selecting suggestions with arrow keys
            const openNewTabButton = document.createElement('button');
    openNewTabButton.id = 'openNewTabButton';
    openNewTabButton.style.borderRadius = '5px';
    openNewTabButton.textContent = 'Open in New Tab';
    document.body.insertBefore(openNewTabButton, iframe);
        openNewTabButton.addEventListener('click', () => {
           const currentUrl = iframe.src;

            if (currentUrl && currentUrl !== 'about:blank') {
                const newTab = window.open('about:blank', '_blank');
                newTab.onload = () => {
                   newTab.document.body.style.margin = '0';
                                       newTab.document.body.style.overflow = 'hidden';


                    newTab.document.body.innerHTML = `<iframe src="${currentUrl}" style="
                        width: 100vw; 

                        
                        height: 100vh; 
                        border: none; 
                        margin: 0; 
                        padding: 0; 
                        position: fixed; 
                        top: 0; left: 0;"></iframe>`;
                };
                 newTab.onerror = () => {
                    // Handle error if the iframe fails to load (e.g., due to Content-Security-Policy)
                    newTab.document.body.style.margin = '0';
                    newTab.document.body.innerHTML = "<h1>Error</h1><p>The website could not be loaded in the iframe.</p>";
                }
            }
          else {
             alert("No URL is loaded");
          }
        });
        window.addEventListener('popstate', function (event) {
            if (event.state && event.state.url) {
                document.getElementById('myIframe').src = event.state.url;
            }
        });

        
        
         document.getElementById('loadButton').addEventListener('click', function () {

         loadIframe(linkInput.value);
        });
           
    </script>
        <script>
         linkInput.addEventListener('keydown', (event) => {
            if (event.key === 'ArrowDown' || event.key === 'ArrowUp') {
                event.preventDefault(); 
            } else if (event.key === 'Enter' && suggestionBox.style.display === 'block') {
                suggestionBox.style.display = 'none';            }
        });
         document.addEventListener('click', (event) => {
            if (!suggestionBox.contains(event.target) && event.target !== linkInput) {
                suggestionBox.style.display = 'none';
            }
        });
            document.getElementById('darkModeToggle').addEventListener('click', function () {
            document.body.classList.toggle('dark-mode');
            const darkModeIcon = document.getElementById('darkModeIcon');
                 if (document.body.classList.contains('dark-mode')) {
                darkModeIcon.textContent = 'light_mode';
                localStorage.setItem('darkMode', 'enabled');
             } else {
                  darkModeIcon.textContent = 'dark_mode';
                localStorage.setItem('darkMode', 'disabled')
            }
        });
           

const settingsIconContainer = document.getElementById('settingsIconContainer');
        // Ensure the settings icon is styled properly for dark mode.
        const materialSettingsIcon = document.getElementById('materialSettingsIcon');
                 if (document.body.classList.contains('dark-mode')) {
             materialSettingsIcon.style.color = '#fff'; // Light color for dark mode
           settingsIconContainer.style.backgroundColor="#555"
        }
          else {
             settingsIconContainer.style.backgroundColor="white"
        }
        if (!document.body.classList.contains('dark-mode')) {
               materialSettingsIcon.style.color = '#333'; // Dark color for dark mode
        }
        </script>
    <script src="/main.js"></script>
</body> 
</html>
